                            <div class="table-responsive">
                                <table class="table table-hover mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th width="40">
                                                <input type="checkbox" class="form-check-input" id="selectAllAccounts">
                                            </th>
                                            <th>Account Holder</th>
                                            <th>Account Number</th>
                                            <th>Account Type</th>
                                            <th>Balance</th>
                                            <th>Status</th>
                                            <th>Created Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% accounts.forEach(account => { %>
                                            <tr>
                                                <td>
                                                    <input type="checkbox" class="form-check-input account-checkbox" 
                                                           value="<%= account._id %>">
                                                </td>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <div class="user-avatar me-3">
                                                            <%= account.userId.name.charAt(0).toUpperCase() %>
                                                        </div>
                                                        <div>
                                                            <div class="fw-semibold"><%= account.userId.name %></div>
                                                            <small class="text-muted"><%= account.userId.email %></small>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <code><%= account.accountNumber %></code>
                                                </td>
                                                <td>
                                                    <span class="text-capitalize">
                                                        <i class="fas fa-<%= account.accountType === 'savings' ? 'piggy-bank' : 'briefcase' %> me-1"></i>
                                                        <%= account.accountType %>
                                                    </span>
                                                </td>
                                                <td>
                                                    <span class="fw-semibold">â‚¹<%= account.balance.toLocaleString() %></span>
                                                </td>
                                                <td>
                                                    <% if (account.status === 'active') { %>
                                                        <span class="badge bg-success">Active</span>
                                                    <% } else if (account.status === 'pending') { %>
                                                        <span class="badge bg-warning">Pending</span>
                                                    <% } else if (account.status === 'blocked') { %>
                                                        <span class="badge bg-danger">Blocked</span>
                                                    <% } else { %>
                                                        <span class="badge bg-secondary">Closed</span>
                                                    <% } %>
                                                </td>
                                                <td>
                                                    <div>
                                                        <%= new Date(account.createdAt).toLocaleDateString() %>
                                                        <br>
                                                        <small class="text-muted">
                                                            <%= new Date(account.createdAt).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %>
                                                        </small>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-primary" 
                                                                onclick="viewAccountDetails('<%= account._id %>')">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <% if (account.status === 'pending') { %>
                                                            <button class="btn btn-outline-success" 
                                                                    onclick="updateAccountStatus('<%= account._id %>', 'active')">
                                                                <i class="fas fa-check"></i>
                                                            </button>
                                                        <% } %>
                                                        <% if (account.status === 'active') { %>
                                                            <button class="btn btn-outline-warning" 
                                                                    onclick="updateAccountStatus('<%= account._id %>', 'blocked')">
                                                                <i class="fas fa-ban"></i>
                                                            </button>
                                                        <% } %>
                                                        <% if (account.status === 'blocked') { %>
                                                            <button class="btn btn-outline-success" 
                                                                    onclick="updateAccountStatus('<%= account._id %>', 'active')">
                                                                <i class="fas fa-unlock"></i>
                                                            </button>
                                                        <% } %>
                                                    </div>
                                                </td>
                                            </tr>
                                        <% }) %>
                                    </tbody>
                                </table>
                            </div>
                        <% } else { %>
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <h5>No Accounts Found</h5>
                                <p class="text-muted">No accounts match your current filters</p>
                                <a href="/admin/accounts" class="btn btn-outline-primary">
                                    <i class="fas fa-refresh me-2"></i>Clear Filters
                                </a>
                            </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function viewAccountDetails(accountId) {
    // Implementation for viewing account details
    console.log('View account:', accountId);
}

function updateAccountStatus(accountId, status) {
    if (confirm(`Are you sure you want to ${status} this account?`)) {
        fetch(`/admin/accounts/${accountId}/status`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ status })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert('Error: ' + data.error);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
        });
    }
}

function exportAccounts() {
    window.open('/admin/accounts/export', '_blank');
}
</script>

<%- include('../partials/footer') %>
